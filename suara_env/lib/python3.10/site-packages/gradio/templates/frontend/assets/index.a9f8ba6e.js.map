{"version":3,"file":"index.a9f8ba6e.js","sources":["../../../../ui/packages/gallery/src/Gallery.svelte","../../../../ui/packages/app/src/components/Gallery/Gallery.svelte","../../../../ui/packages/app/src/components/Gallery/index.ts"],"sourcesContent":["<script lang=\"ts\">\n\timport { BlockLabel, Empty } from \"@gradio/atoms\";\n\timport { ModifyUpload } from \"@gradio/upload\";\n\timport { tick } from \"svelte\";\n\n\timport type { Styles } from \"@gradio/utils\";\n\timport { get_styles } from \"@gradio/utils\";\n\timport { Image } from \"@gradio/icons\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\n\texport let show_label: boolean = true;\n\texport let label: string;\n\texport let root: string = \"\";\n\texport let root_url: null | string = null;\n\texport let value: Array<string> | Array<FileData> | null = null;\n\texport let style: Styles = { grid: [2], height: \"auto\" };\n\n\t$: _value =\n\t\tvalue === null\n\t\t\t? null\n\t\t\t: value.map((img) =>\n\t\t\t\t\tArray.isArray(img)\n\t\t\t\t\t\t? [normalise_file(img[0], root, root_url), img[1]]\n\t\t\t\t\t\t: [normalise_file(img, root, root_url), null]\n\t\t\t  );\n\n\tlet prevValue: string[] | FileData[] | null = null;\n\tlet selected_image: number | null = null;\n\t$: if (prevValue !== value) {\n\t\t// so that gallery preserves selected image after update\n\t\tselected_image =\n\t\t\tselected_image !== null && value !== null && selected_image < value.length\n\t\t\t\t? selected_image\n\t\t\t\t: null;\n\t\tprevValue = value;\n\t}\n\n\t$: previous =\n\t\t((selected_image ?? 0) + (_value?.length ?? 0) - 1) % (_value?.length ?? 0);\n\t$: next = ((selected_image ?? 0) + 1) % (_value?.length ?? 0);\n\n\tfunction on_keydown(e: KeyboardEvent) {\n\t\tswitch (e.code) {\n\t\t\tcase \"Escape\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = null;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowLeft\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = previous;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowRight\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = next;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t$: scroll_to_img(selected_image);\n\n\tlet el: Array<HTMLButtonElement> = [];\n\tlet container: HTMLDivElement;\n\n\tasync function scroll_to_img(index: number | null) {\n\t\tif (typeof index !== \"number\") return;\n\t\tawait tick();\n\n\t\tel[index].focus();\n\n\t\tconst { left: container_left, width: container_width } =\n\t\t\tcontainer.getBoundingClientRect();\n\t\tconst { left, width } = el[index].getBoundingClientRect();\n\n\t\tconst relative_left = left - container_left;\n\n\t\tconst pos =\n\t\t\trelative_left + width / 2 - container_width / 2 + container.scrollLeft;\n\n\t\tcontainer.scrollTo({\n\t\t\tleft: pos < 0 ? 0 : pos,\n\t\t\tbehavior: \"smooth\"\n\t\t});\n\t}\n\n\t$: can_zoom = window_height >= height;\n\n\t$: ({ styles } = get_styles(style, [\"grid\"]));\n\n\tlet height = 0;\n\tlet window_height = 0;\n</script>\n\n<svelte:window bind:innerHeight={window_height} />\n\n{#if show_label}\n\t<BlockLabel\n\t\t{show_label}\n\t\tIcon={Image}\n\t\tlabel={label || \"Gallery\"}\n\t\tdisable={typeof style.container === \"boolean\" && !style.container}\n\t/>\n{/if}\n{#if value === null || _value === null || _value.length === 0}\n\t<Empty size=\"large\" unpadded_box={true}><Image /></Empty>\n{:else}\n\t{#if selected_image !== null}\n\t\t<div\n\t\t\ton:keydown={on_keydown}\n\t\t\tclass=\"preview\"\n\t\t\tclass:fixed-height={style.height !== \"auto\"}\n\t\t>\n\t\t\t<ModifyUpload on:clear={() => (selected_image = null)} />\n\n\t\t\t<img\n\t\t\t\ton:click={() => (selected_image = next)}\n\t\t\t\tsrc={_value[selected_image][0].data}\n\t\t\t\talt={_value[selected_image][1] || \"\"}\n\t\t\t\ttitle={_value[selected_image][1] || null}\n\t\t\t\tclass:with-caption={!!_value[selected_image][1]}\n\t\t\t\tstyle=\"height: calc(100% - {_value[selected_image][1]\n\t\t\t\t\t? '80px'\n\t\t\t\t\t: '60px'})\"\n\t\t\t/>\n\t\t\t{#if _value[selected_image][1]}\n\t\t\t\t<div class=\"caption\">\n\t\t\t\t\t{_value[selected_image][1]}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t\t<div bind:this={container} class=\"thumbnails scroll-hide\">\n\t\t\t\t{#each _value as image, i}\n\t\t\t\t\t<button\n\t\t\t\t\t\tbind:this={el[i]}\n\t\t\t\t\t\ton:click={() => (selected_image = i)}\n\t\t\t\t\t\tclass=\"thumbnail-item thumbnail-small \"\n\t\t\t\t\t\tclass:selected={selected_image === i}\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={image[0].data}\n\t\t\t\t\t\t\ttitle={image[1] || null}\n\t\t\t\t\t\t\talt={image[1] || null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</button>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n\n\t<div\n\t\tbind:clientHeight={height}\n\t\tclass=\"grid-wrap\"\n\t\tclass:fixed-height={style.height !== \"auto\"}\n\t>\n\t\t<div class=\"grid-container\" style={styles} class:pt-6={show_label}>\n\t\t\t{#each _value as [image, caption], i}\n\t\t\t\t<button\n\t\t\t\t\tclass=\"thumbnail-item thumbnail-lg\"\n\t\t\t\t\tclass:selected={selected_image === i}\n\t\t\t\t\ton:click={() => (selected_image = can_zoom ? i : selected_image)}\n\t\t\t\t>\n\t\t\t\t\t<img\n\t\t\t\t\t\talt={caption || \"\"}\n\t\t\t\t\t\tsrc={typeof image === \"string\" ? image : image.data}\n\t\t\t\t\t/>\n\t\t\t\t\t{#if caption}\n\t\t\t\t\t\t<div class=\"caption-label\">\n\t\t\t\t\t\t\t{caption}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t{/each}\n\t\t</div>\n\t</div>\n{/if}\n\n<style lang=\"postcss\">\n\t.preview {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\tflex-direction: column;\n\t\tz-index: var(--layer-2);\n\t\tbackdrop-filter: blur(8px);\n\t\tbackground: var(--color-background-primary);\n\t\theight: var(--size-full);\n\t}\n\n\t.fixed-height {\n\t\tmin-height: var(--size-80);\n\t\tmax-height: 55vh;\n\t}\n\n\t@media (--screen-xl) {\n\t\t.fixed-height {\n\t\t\tmin-height: 450px;\n\t\t}\n\t}\n\n\t.preview img {\n\t\twidth: var(--size-full);\n\t\theight: calc(var(--size-full) - 60px);\n\t\tobject-fit: contain;\n\t}\n\n\t.preview img.with-caption {\n\t\theight: calc(var(--size-full) - 80px);\n\t}\n\n\t.caption {\n\t\tpadding: var(--size-2) var(--size-3);\n\t\toverflow: hidden;\n\t\tcolor: var(--color-text-label);\n\t\tfont-weight: var(--weight-semibold);\n\t\ttext-align: center;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.thumbnails {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: var(--size-2);\n\t\twidth: var(--size-full);\n\t\theight: var(--size-14);\n\t\toverflow-x: scroll;\n\t\tfont-size: var(--scale-00);\n\t}\n\n\t.thumbnail-item {\n\t\t--ring-color: transparent;\n\t\tposition: relative;\n\t\toutline: none;\n\t\tbox-shadow: 0 0 0 2px var(--ring-color), var(--shadow-drop);\n\t\tborder: 1px solid var(--gallery-thumb-border-color-base);\n\t\tborder-radius: var(--radius-sm);\n\t\tbackground-color: var(--gallery-thumb-background-base);\n\t\taspect-ratio: var(--ratio-square);\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\toverflow: hidden;\n\t}\n\n\t.thumbnail-item:hover {\n\t\t--ring-color: var(--gallery-thumb-border-color-hover);\n\t\tfilter: brightness(1.1);\n\t\tborder-color: var(--gallery-thumb-border-color-hover);\n\t}\n\n\t.thumbnail-item:focus {\n\t\t--ring-color: var(--gallery-thumb-border-color-focus);\n\t\tborder-color: var(--gallery-thumb-border-color-focus);\n\t}\n\n\t.thumbnail-small {\n\t\tflex: none;\n\t\ttransform: scale(0.9);\n\t\ttransition: 0.075s;\n\t\twidth: var(--size-9);\n\t\theight: var(--size-9);\n\t}\n\n\t.thumbnail-small.selected {\n\t\t--ring-color: var(--gallery-thumb-border-color-selected);\n\t\ttransform: scale(1);\n\t\tborder-color: var(--gallery-thumb-border-color-selected);\n\t}\n\n\t.thumbnail-small.selected:focus {\n\t\t--ring-color: var(--gallery-thumb-border-color-focus) !important;\n\t\tborder-color: var(--gallery-thumb-border-color-focus) !important;\n\t}\n\n\t.thumbnail-small > img {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\toverflow: hidden;\n\t\tobject-fit: cover;\n\t}\n\n\t.grid-wrap {\n\t\tpadding: var(--size-2);\n\t\theight: var(--size-full);\n\t\toverflow-y: auto;\n\t}\n\n\t.grid-container {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: var(--grid-cols);\n\t\tgap: var(--size-2);\n\t}\n\t@media (--screen-sm) {\n\t\t.grid-container {\n\t\t\tgrid-template-columns: var(--sm-grid-cols);\n\t\t}\n\t}\n\t@media (--screen-md) {\n\t\t.grid-container {\n\t\t\tgrid-template-columns: var(--md-grid-cols);\n\t\t}\n\t}\n\t@media (--screen-lg) {\n\t\t.grid-container {\n\t\t\tgrid-template-columns: var(--lg-grid-cols);\n\t\t}\n\t}\n\t@media (--screen-xl) {\n\t\t.grid-container {\n\t\t\tgrid-template-columns: var(--xl-grid-cols);\n\t\t}\n\t}\n\t@media (--screen-xxl) {\n\t\t.grid-container {\n\t\t\tgrid-template-columns: var(--2xl-grid-cols);\n\t\t}\n\t}\n\n\t.thumbnail-lg > img {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\toverflow: hidden;\n\t\tobject-fit: cover;\n\t}\n\n\t.thumbnail-lg:hover .caption-label {\n\t\topacity: 0.5;\n\t}\n\n\t.caption-label {\n\t\tposition: absolute;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tz-index: var(--layer-1);\n\t\tborder-top: 1px solid var(--gallery-label-border-color-base);\n\t\tborder-left: 1px solid var(--gallery-label-border-color-base);\n\t\tborder-top-left-radius: var(--radius-lg);\n\t\tbackground: var(--gallery-thumb-background-base);\n\t\tpadding: var(--size-1) var(--size-3);\n\t\tmax-width: 80%;\n\t\toverflow: hidden;\n\t\tfont-weight: var(--weight-semibold);\n\t\tfont-size: var(--scale-000);\n\t\ttext-align: left;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { Block } from \"@gradio/atoms\";\n\timport { Gallery } from \"@gradio/gallery\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { Styles } from \"@gradio/utils\";\n\timport type { FileData } from \"@gradio/upload\";\n\n\texport let loading_status: LoadingStatus;\n\texport let show_label: boolean;\n\texport let label: string;\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: Array<string> | Array<FileData> | null = null;\n\texport let style: Styles = {};\n</script>\n\n<Block\n\t{visible}\n\tvariant=\"solid\"\n\tcolor=\"grey\"\n\tpadding={false}\n\t{elem_id}\n\tdisable={typeof style.container === \"boolean\" && !style.container}\n>\n\t<StatusTracker {...loading_status} />\n\t<Gallery {label} {value} {style} {show_label} {root} {root_url} />\n</Block>\n","export { default as Component } from \"./Gallery.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"Array<{ name: string } | [{ name: string }, string]>\",\n\tdescription: \"list of objects with filename and optional caption\"\n});\n"],"names":[],"mappings":"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"}