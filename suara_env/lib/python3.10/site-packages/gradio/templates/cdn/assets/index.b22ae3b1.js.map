{"version":3,"file":"index.b22ae3b1.js","sources":["../../../../ui/packages/icons/src/TextHighlight.svelte","../../../../ui/packages/highlighted-text/src/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/index.ts"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\txmlns:xlink=\"http://www.w3.org/1999/xlink\"\n\taria-hidden=\"true\"\n\trole=\"img\"\n\tclass=\"iconify iconify--carbon\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tpreserveAspectRatio=\"xMidYMid meet\"\n\tviewBox=\"0 0 32 32\"\n>\n\t<path\n\t\tfill=\"currentColor\"\n\t\td=\"M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z\"\n\t/>\n\t<path\n\t\tfill=\"currentColor\"\n\t\td=\"M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\tconst browser = typeof document !== \"undefined\";\n\timport { colors } from \"@gradio/theme\";\n\timport { get_next_color } from \"@gradio/utils\";\n\n\texport let value: Array<[string, string | number]> = [];\n\texport let show_legend: boolean = false;\n\texport let color_map: Record<string, string> = {};\n\n\tlet ctx: CanvasRenderingContext2D;\n\n\tlet _color_map: Record<string, { primary: string; secondary: string }> = {};\n\tlet active = \"\";\n\n\tfunction name_to_rgba(name: string, a: number) {\n\t\tif (!ctx) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tctx = canvas.getContext(\"2d\")!;\n\t\t}\n\t\tctx.fillStyle = name;\n\t\tctx.fillRect(0, 0, 1, 1);\n\t\tconst [r, g, b] = ctx.getImageData(0, 0, 1, 1).data;\n\t\tctx.clearRect(0, 0, 1, 1);\n\t\treturn `rgba(${r}, ${g}, ${b}, ${255 / a})`;\n\t}\n\n\tlet mode: \"categories\" | \"scores\";\n\n\t$: {\n\t\tif (!color_map) {\n\t\t\tcolor_map = {};\n\t\t}\n\t\tif (value.length > 0) {\n\t\t\tfor (let [_, label] of value) {\n\t\t\t\tif (label !== null) {\n\t\t\t\t\tif (typeof label === \"string\") {\n\t\t\t\t\t\tmode = \"categories\";\n\t\t\t\t\t\tif (!(label in color_map)) {\n\t\t\t\t\t\t\tlet color = get_next_color(Object.keys(color_map).length);\n\t\t\t\t\t\t\tcolor_map[label] = color;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmode = \"scores\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction correct_color_map() {\n\t\t\tfor (const col in color_map) {\n\t\t\t\tconst _c = color_map[col].trim();\n\t\t\t\tif (_c in colors) {\n\t\t\t\t\t_color_map[col] = colors[_c as keyof typeof colors];\n\t\t\t\t} else {\n\t\t\t\t\t_color_map[col] = {\n\t\t\t\t\t\tprimary: browser ? name_to_rgba(color_map[col], 1) : color_map[col],\n\t\t\t\t\t\tsecondary: browser\n\t\t\t\t\t\t\t? name_to_rgba(color_map[col], 0.5)\n\t\t\t\t\t\t\t: color_map[col]\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcorrect_color_map();\n\t}\n\n\tfunction handle_mouseover(label: string) {\n\t\tactive = label;\n\t}\n\tfunction handle_mouseout() {\n\t\tactive = \"\";\n\t}\n</script>\n\n<!-- \n\t@todo victor: try reimplementing without flex (negative margins on container to avoid left margin on linebreak). \n\tIf not possible hijack the copy execution like this:\n\n<svelte:window\n\ton:copy|preventDefault={() => {\n\t\tconst selection =.getSelection()?.toString();\n\t\tconsole.log(selection?.replaceAll(\"\\n\", \" \"));\n\t}}\n/>\n-->\n\n{#if mode === \"categories\"}\n\t{#if show_legend}\n\t\t<div class=\"category-legend\" data-testid=\"highlighted-text:category-legend\">\n\t\t\t{#each Object.entries(_color_map) as [category, color], i}\n\t\t\t\t<div\n\t\t\t\t\ton:mouseover={() => handle_mouseover(category)}\n\t\t\t\t\ton:focus={() => handle_mouseover(category)}\n\t\t\t\t\ton:mouseout={() => handle_mouseout()}\n\t\t\t\t\ton:blur={() => handle_mouseout()}\n\t\t\t\t\tclass=\"category-label\"\n\t\t\t\t\tstyle={\"background-color:\" + color.secondary}\n\t\t\t\t>\n\t\t\t\t\t{category}\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n\t<div class=\"textfield\">\n\t\t{#each value as [text, category]}\n\t\t\t<span\n\t\t\t\tclass=\"textspan\"\n\t\t\t\tstyle:background-color={category === null ||\n\t\t\t\t(active && active !== category)\n\t\t\t\t\t? \"\"\n\t\t\t\t\t: _color_map[category].secondary}\n\t\t\t\tclass:no-cat={category === null || (active && active !== category)}\n\t\t\t\tclass:hl={category !== null}\n\t\t\t>\n\t\t\t\t<span class:no-label={!_color_map[category]} class=\"text\">{text}</span>\n\t\t\t\t{#if !show_legend && category !== null}\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"label\"\n\t\t\t\t\t\tstyle:background-color={category === null ||\n\t\t\t\t\t\t(active && active !== category)\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: _color_map[category].primary}\n\t\t\t\t\t>\n\t\t\t\t\t\t{category}\n\t\t\t\t\t</span>\n\t\t\t\t{/if}\n\t\t\t</span>\n\t\t{/each}\n\t</div>\n{:else}\n\t{#if show_legend}\n\t\t<div class=\"color-legend\" data-testid=\"highlighted-text:color-legend\">\n\t\t\t<span>-1</span>\n\t\t\t<span>0</span>\n\t\t\t<span>+1</span>\n\t\t</div>\n\t{/if}\n\t<div class=\"textfield\" data-testid=\"highlighted-text:textfield\">\n\t\t{#each value as [text, score]}\n\t\t\t<span\n\t\t\t\tclass=\"textspan score-text\"\n\t\t\t\tstyle={\"background-color: rgba(\" +\n\t\t\t\t\t(score < 0 ? \"128, 90, 213,\" + -score : \"239, 68, 60,\" + score) +\n\t\t\t\t\t\")\"}\n\t\t\t>\n\t\t\t\t<span class=\"text\">{text}</span>\n\t\t\t</span>\n\t\t{/each}\n\t</div>\n{/if}\n\n<style>\n\t.hl + .hl {\n\t\tmargin-left: var(--size-1);\n\t}\n\n\t.textspan:last-child > .label {\n\t\tmargin-right: 0;\n\t}\n\n\t.category-legend {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: var(--size-1);\n\t\tmargin-top: var(--size-7);\n\t\tmargin-bottom: var(--size-2);\n\t\tcolor: black;\n\t}\n\n\t.category-label {\n\t\tcursor: pointer;\n\t\tborder-radius: var(--radius-xs);\n\t\tpadding-right: var(--size-2);\n\t\tpadding-left: var(--size-2);\n\t\tfont-weight: var(--weight-semibold);\n\t}\n\n\t.color-legend {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-top: var(--size-7);\n\t\tmargin-bottom: var(--size-3);\n\t\tborder-radius: var(--radius-xs);\n\t\tbackground: linear-gradient(\n\t\t\tto right,\n\t\t\tvar(--color-purple),\n\t\t\trgba(255, 255, 255, 0),\n\t\t\tvar(--color-red)\n\t\t);\n\t\tpadding: var(--size-1) var(--size-2);\n\t\tfont-weight: var(--weight-semibold);\n\t}\n\n\t.textfield {\n\t\tbox-sizing: border-box;\n\t\tmargin-top: var(--size-7);\n\t\tborder-radius: var(--radius-xs);\n\t\tbackground: var(--color-background-primary);\n\t\tbackground-color: transparent;\n\t\tmax-width: var(--size-full);\n\t\tfont-size: var(--scale-00);\n\t\tline-height: var(--scale-4);\n\t\tword-break: break-all;\n\t}\n\n\t.textspan {\n\t\ttransition: 150ms;\n\t\tborder-radius: var(--radius-xs);\n\t\tpadding-top: 2.5px;\n\t\tpadding-right: var(--size-1);\n\t\tpadding-bottom: 3.5px;\n\t\tpadding-left: var(--size-1);\n\t\tcolor: black;\n\t}\n\n\t.label {\n\t\ttransition: 150ms;\n\t\tmargin-top: 1px;\n\t\tmargin-right: calc(var(--size-1) * -1);\n\t\tborder-radius: var(--radius-xs);\n\t\tpadding: 1px 5px;\n\t\tcolor: var(--color-text-body);\n\t\tcolor: white;\n\t\tfont-weight: var(--weight-bold);\n\t\tfont-size: var(--scale-000);\n\t\ttext-transform: uppercase;\n\t}\n\n\t.text {\n\t\tcolor: black;\n\t}\n\n\t.score-text .text {\n\t\tcolor: var(--color-text-body);\n\t}\n\n\t.score-text {\n\t\tmargin-right: var(--size-1);\n\t\tpadding: var(--size-1);\n\t}\n\n\t.no-cat {\n\t\tcolor: var(--color-text-body);\n\t}\n\n\t.no-label {\n\t\tcolor: var(--color-text-body);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { HighlightedText } from \"@gradio/highlighted-text\";\n\timport { Block, BlockLabel, Empty } from \"@gradio/atoms\";\n\timport { TextHighlight } from \"@gradio/icons\";\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport type { Styles } from \"@gradio/utils\";\n\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: Array<[string, string | number]>;\n\tlet old_value: Array<[string, string | number]>;\n\texport let show_legend: boolean;\n\texport let color_map: Record<string, string> = {};\n\texport let label: string;\n\texport let style: Styles = {};\n\n\t$: if (!style.color_map && Object.keys(color_map).length) {\n\t\tstyle.color_map = color_map;\n\t}\n\n\texport let loading_status: LoadingStatus;\n\n\tconst dispatch = createEventDispatcher<{ change: undefined }>();\n\n\t$: {\n\t\tif (value !== old_value) {\n\t\t\told_value = value;\n\t\t\tdispatch(\"change\");\n\t\t}\n\t}\n</script>\n\n<Block\n\ttest_id=\"highlighted-text\"\n\t{visible}\n\t{elem_id}\n\tdisable={typeof style.container === \"boolean\" && !style.container}\n>\n\t<StatusTracker {...loading_status} />\n\t{#if label}\n\t\t<BlockLabel\n\t\t\tIcon={TextHighlight}\n\t\t\t{label}\n\t\t\tdisable={typeof style.container === \"boolean\" && !style.container}\n\t\t/>\n\t{/if}\n\n\t{#if value}\n\t\t<HighlightedText {value} {show_legend} color_map={style.color_map} />\n\t{:else}\n\t\t<Empty>\n\t\t\t<TextHighlight />\n\t\t</Empty>\n\t{/if}\n</Block>\n","export { default as Component } from \"./HighlightedText.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"Array<[string, string | number]>\",\n\tdescription: \"list of text spans and corresponding label / value\"\n});\n"],"names":["document"],"mappings":"osCAAA,SAWC,OAIA,iWCoHK,YAQG,0BAAL,4NADH,+DAPK,oEAQG,uBAAL,6HAAA,0EApDE,aAiBG,0BAAL,6KADH,+DAhBK,8EAiBG,uBAAL,8HAAA;;0HA4BF,iDAcsB,kKAJb,0BACL,OAAQ,EAAI,iBAAmB,MAAQ,eAAiB,OACzD,GAAG,UAJL,SAMC,yCAAoB,8BAJb,0BACL,OAAQ,EAAI,iBAAmB,MAAQ,eAAiB,OACzD,2DAvDK,OAAO,QAAQ,2BAApB,oMADH,wEACQ,OAAO,QAAQ,wBAApB,6HAAA,qDASC,iLAFM,oBAAsB,MAAM,SAAS,UAN7C,uIAQE,8BAFM,oBAAsB,MAAM,+EA4BjC,0BATmC;AAAA,MAErC,gFAEyB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,6BALzB,oCAOE,+CALuB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,6DARiC,kBACrD,MAAe,QAAa,8HADX,KAAW,4DAHpB,QAAa,MAAS,MAAU,OAAW,gBAC/C,QAAa,IAAI,yBALH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,sBALzB,SASC,+DAA2D,uCAApC,KAAW,SAC5B,MAAe,QAAa,8EAJpB,QAAa,MAAS,MAAU,OAAW,qBAC/C,QAAa,IAAI,+BALH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,kFAxBvB,QAAS,gOArFP,SAAiB,UAAa,QAIzB,eACA,cAAuB,OACvB,kBAEP,EAEA,KACA,EAAS,cAES,EAAc,OAC9B,MACA,GAAS,SAAS,cAAc,QAAQ,EAC5C,EAAM,EAAO,WAAW,IAAI,EAE7B,EAAI,UAAY,EAChB,EAAI,SAAS,EAAG,EAAG,EAAG,CAAC,QAChB,EAAG,GAAG,IAAK,EAAI,aAAa,EAAG,EAAG,EAAG,CAAC,EAAE,KAC/C,SAAI,UAAU,EAAG,EAAG,EAAG,CAAC,UACT,MAAM,OAAM,OAAM,IAAM,QAGpC,cAwCsB,OACzB,EAAS,CAAK,mBAGd,EAAS,EAAE,aAqBY,EAAiB,CAAQ,OAC7B,EAAiB,CAAQ,QACtB,UACJ,uKA/CT,uBACG,KAAO,SACX,GAAK,EAAU,GAAK,OACtB,IAAM,OACT,EAAW,GAAO,EAAO,UAEzB,EAAW,IACV,QAAS,EAAU,EAAa,EAAU,GAAM,CAAC,EAAI,EAAU,GAC/D,UAAW,EACR,EAAa,EAAU,GAAM,EAAG,EAChC,EAAU,YA5BZ,OACJ,MAEG,EAAM,OAAS,WACR,EAAG,IAAU,MAClB,IAAU,cACF,IAAU,iBACpB,EAAO,YAAY,GACb,KAAS,QACV,GAAQ,GAAe,OAAO,KAAK,CAAS,EAAE,MAAM,MACxD,EAAU,GAAS,eAGpB,EAAO,QAAQ,EAqBnB,qLCpBO,4BAEU,MAAM,WAAc,YAAc,KAAM,uHAAxC,MAAM,WAAc,YAAc,KAAM,gdAKP,KAAM,6IAAN,KAAM,sTAVtC,kFACd,uDAQA,sMATc,qBACd,0fAHW,MAAM,WAAc,YAAc,KAAM,uLAAxC,MAAM,WAAc,YAAc,KAAM,gKA7B7C,UAAkB,OAClB,UAAmB,OACnB,WACP,GACO,kBACA,mBACA,YACA,eAMA,yBAEL,GAAW,yUANT,EAAM,WAAa,OAAO,KAAK,CAAS,EAAE,YACjD,EAAM,UAAY,qBAQd,IAAU,QACb,EAAY,CAAK,EACjB,EAAS,QAAQ,6LC5BP,IAAQ,CAAC,QAAQ,EAEjBA,GAAW,AAAC,KACxB,KAAM,mCACN,YAAa,oDACd"}